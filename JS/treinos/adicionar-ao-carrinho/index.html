<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Loja Virtual</title>
</head>
<body>
    <header>
        <div id="sombra" onclick="fecharCarrinho()"></div>
        <div id="carrinho"></div>
        <h2>Loja Online</h3>
        <button id="btncarrinho" onclick="abrirCarrinho()">
            <div id="Qcarrinho">
                <p id="notificacao"></p>
            </div>
            Carrinho
        </button>
    </header>

    <main>
    </main>

    <script>
        const num = localStorage.getItem('num')
        const numSalvo = JSON.parse(num)

        // Vai criar os produtos
        const main = document.querySelector('main')
        var numero = numSalvo
        let salavarCarrinho = []

        for(let c = 1; c < 21; c++) {
            const div1 = document.createElement('div') 
            const div2 = document.createElement('div') 
            const h3 = document.createElement('h3') 
            const p = document.createElement('p') 
            const carrinho = document.querySelector('#carrinho')

            h3.innerText = `Produto ${c}`
            p.innerText = `Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloribus, libero corporis!`

            
            main.appendChild(div1)
            div1.appendChild(div2)
            div1.appendChild(h3)
            div1.appendChild(p)
            
            // Vai acontecer quando clicar em alguma div
            let numArray = []
            div1.addEventListener('click', function() {
                numero++
                carrinho.innerHTML += `<p>${h3.innerText = `Produto ${c}`}</p>`
                    
                let divNotificacao = document.querySelector('#Qcarrinho')
                let notificacaoCarrinho = document.querySelector('#notificacao')
                divNotificacao.style.display = 'block'
                notificacaoCarrinho.innerText = numero

                salavarCarrinho.push(`<p>${h3.innerText = `Produto ${c}`}</p>`)
                console.log(salavarCarrinho);
                numArray.push(numero)

                var numSalvo = JSON.stringify(numArray);
                localStorage.setItem('num', numSalvo);
                console.log(numArray);

                var carrinhoJSON = JSON.stringify(salavarCarrinho);
                localStorage.setItem('addcarrinho', carrinhoJSON);
            })
        }

        function abrirCarrinho() {
            const carrinho = document.querySelector('#carrinho')
            const sombra = document.querySelector('#sombra')

            if(carrinho.style.display == 'block') {
                carrinho.style.display = 'none'
                sombra.style.display = 'none'

            } else {
                carrinho.style.display = 'block'
                sombra.style.display = 'block'
            }
        }
    
        function adicionaProdutosSalvos() {
            const carrinho3 = localStorage.getItem('addcarrinho')
            const carrinho1 = JSON.parse(carrinho3)

            const num = localStorage.getItem('num')
            const numSalvo = JSON.parse(num)
            const carrinho = document.querySelector('#carrinho')
            let q = numSalvo[0]

            for(let c = 0; c < q; c++) {
                let divNotificacao = document.querySelector('#Qcarrinho')
                let notificacaoCarrinho = document.querySelector('#notificacao')
                divNotificacao.style.display = 'block'
                notificacaoCarrinho.innerText = numSalvo

                carrinho.innerHTML += carrinho1[c]
            } 
        }
        adicionaProdutosSalvos();
    </script>
</body>
</html>